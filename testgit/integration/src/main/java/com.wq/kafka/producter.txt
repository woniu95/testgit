
//初始化
Properties props = new Properties();
long begin = System.currentTimeMillis();
props.put("group.id", "local_sync");
props.put("key.serializer", kafkaConfiguration.getKeySerializer());
props.put("value.serializer", kafkaConfiguration.getValueSerializer());
props.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG, kafkaConfiguration.getFullIp());
logger.info(" kafka sender processor init ... ");
kafkaProducer = new KafkaProducer<String, String>(props);


//发送
ProducerRecord<String, String> msg = new ProducerRecord<>(topic, 0, null, value);
			Future<RecordMetadata> f = kafkaProducer.send(msg);
			RecordMetadata resp = f.get();
			logger.info(" send message topic: " + topic + ", offset : " + resp.offset());